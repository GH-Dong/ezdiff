machine:
    python:
        version: 3.5.2
    pre:
        - if [ ! -e '/home/ubuntu/virtualenvs/venv-3.5.2' ]; then mkdir -p '/home/ubuntu/virtualenvs'; pushd '/home/ubuntu/virtualenvs'; virtualenv venv-3.5.2; popd; fi
    post:
        - wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O ~/miniconda.sh
        - bash ~/miniconda.sh -b -p $HOME/miniconda
    environment:
        PATH: "$HOME/miniconda/bin:$PATH"

dependencies:
    override:
        - conda update conda
        - conda install --yes anaconda-client anaconda-build conda-build
        - conda config --add channels r
        - conda install --yes r r-essentials
        - $HOME/miniconda/bin/pip install rpy2
        - $HOME/miniconda/bin/pip install pytest

test:
    override:
        - py.test